Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://azcedledgev001.v01caedl.manulife.com:4040
Spark context available as 'sc' (master = local[*], app id = local-1590341698019).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.3.0.2.6.5.149-2
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_241)
Type in expressions to have them evaluated.
Type :help for more information.

scala> val t_process_date = "2020-05-17"
t_process_date: String = 2020-05-17

scala> val s_process_date = "2020-05-01"
s_process_date: String = 2020-05-01

scala> :load '07_ComparisonScripts_acpos.spark' 
Loading 07_ComparisonScripts_acpos.spark...
r1: org.apache.spark.sql.DataFrame = [acct: string, cusip: string ... 35 more fields]
r2: org.apache.spark.sql.DataFrame = [acct: string, cusip: string ... 35 more fields]
diff: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [acct: string, cusip: string ... 35 more fields]
20/05/24 13:35:11 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
[Stage 0:>                                                         (0 + 8) / 47][Stage 0:>                 (0 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:>                 (1 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:>                 (2 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=>                (5 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:===>              (8 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:===>              (9 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:===>             (10 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:===>             (11 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=====>           (16 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:======>          (17 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:======>          (18 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:======>          (19 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=======>         (21 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:========>        (23 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=========>       (25 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=========>       (26 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=========>       (27 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:==========>      (28 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:==========>      (29 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:==========>      (30 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:===========>     (33 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:============>    (34 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:============>    (35 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=============>   (36 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=============>   (37 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:=============>   (38 + 8) / 47][Stage 1:>                 (0 + 0) / 34][Stage 0:==============>  (41 + 6) / 47][Stage 1:>                 (0 + 2) / 34][Stage 0:==============>  (41 + 6) / 47][Stage 1:=>                (2 + 2) / 34][Stage 0:===============> (42 + 5) / 47][Stage 1:=>                (2 + 3) / 34][Stage 0:===============> (43 + 4) / 47][Stage 1:=>                (2 + 4) / 34][Stage 0:===============> (44 + 3) / 47][Stage 1:=>                (2 + 5) / 34][Stage 0:================>(45 + 2) / 47][Stage 1:=>                (3 + 6) / 34][Stage 0:================>(46 + 1) / 47][Stage 1:==>               (4 + 7) / 34][Stage 1:========>                                                 (5 + 8) / 34][Stage 1:==========>                                               (6 + 8) / 34][Stage 1:===========>                                              (7 + 8) / 34][Stage 1:=============>                                            (8 + 8) / 34][Stage 1:===============>                                          (9 + 8) / 34][Stage 1:================>                                        (10 + 8) / 34][Stage 1:==================>                                      (11 + 8) / 34][Stage 1:====================>                                    (12 + 8) / 34][Stage 1:=======================>                                 (14 + 8) / 34][Stage 1:=========================>                               (15 + 8) / 34][Stage 1:==========================>                              (16 + 8) / 34][Stage 1:============================>                            (17 + 8) / 34][Stage 1:==============================>                          (18 + 8) / 34][Stage 1:===============================>                         (19 + 8) / 34][Stage 1:=================================>                       (20 + 8) / 34][Stage 1:===================================>                     (21 + 8) / 34][Stage 1:====================================>                    (22 + 8) / 34][Stage 1:========================================>                (24 + 8) / 34][Stage 1:=========================================>               (25 + 8) / 34][Stage 1:===========================================>             (26 + 8) / 34][Stage 1:=============================================>           (27 + 7) / 34][Stage 1:==============================================>          (28 + 6) / 34][Stage 1:================================================>        (29 + 5) / 34][Stage 1:==================================================>      (30 + 4) / 34][Stage 1:===================================================>     (31 + 3) / 34][Stage 1:=======================================================> (33 + 1) / 34][Stage 2:>                                                        (0 + 8) / 200][Stage 2:==>                                                      (8 + 8) / 200][Stage 2:====>                                                   (16 + 8) / 200][Stage 2:=====>                                                  (19 + 8) / 200][Stage 2:======>                                                 (24 + 8) / 200][Stage 2:========>                                               (29 + 8) / 200][Stage 2:========>                                               (32 + 8) / 200][Stage 2:=========>                                              (34 + 9) / 200][Stage 2:===========>                                            (40 + 8) / 200][Stage 2:===========>                                            (41 + 8) / 200][Stage 2:============>                                           (46 + 8) / 200][Stage 2:=============>                                          (49 + 8) / 200][Stage 2:==============>                                         (51 + 8) / 200][Stage 2:===============>                                        (57 + 8) / 200][Stage 2:================>                                       (60 + 8) / 200][Stage 2:==================>                                     (66 + 8) / 200][Stage 2:===================>                                    (69 + 8) / 200][Stage 2:====================>                                   (74 + 8) / 200][Stage 2:======================>                                 (80 + 8) / 200][Stage 2:=======================>                                (83 + 8) / 200][Stage 2:=========================>                              (90 + 8) / 200][Stage 2:==========================>                             (94 + 8) / 200][Stage 2:===========================>                           (100 + 8) / 200][Stage 2:============================>                          (104 + 8) / 200][Stage 2:==============================>                        (110 + 8) / 200][Stage 2:===============================>                       (116 + 8) / 200][Stage 2:================================>                      (119 + 8) / 200][Stage 2:==================================>                    (125 + 8) / 200][Stage 2:====================================>                  (131 + 8) / 200][Stage 2:====================================>                  (134 + 8) / 200][Stage 2:======================================>                (141 + 8) / 200][Stage 2:=======================================>               (142 + 8) / 200][Stage 2:=========================================>             (150 + 8) / 200][Stage 2:===========================================>           (157 + 8) / 200][Stage 2:============================================>          (161 + 8) / 200][Stage 2:=============================================>         (166 + 8) / 200][Stage 2:===============================================>       (173 + 8) / 200][Stage 2:================================================>      (175 + 8) / 200][Stage 2:==================================================>    (182 + 8) / 200][Stage 2:====================================================>  (190 + 8) / 200][Stage 2:====================================================>  (191 + 8) / 200][Stage 2:======================================================>(199 + 1) / 200][Stage 3:===============================>                       (116 + 8) / 200][Stage 3:============================================>          (163 + 8) / 200]                                                                                Count with mismatches = 0
[Stage 5:=>                (2 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=>                (3 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:==>               (4 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:==>               (5 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:===>              (6 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:====>             (8 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:====>             (9 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=====>           (10 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=====>           (11 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:======>          (13 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=======>         (14 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=======>         (15 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:========>        (16 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:========>        (17 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=========>       (19 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:==========>      (20 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:==========>      (21 + 9) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:===========>     (22 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:============>    (24 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:============>    (24 + 9) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:============>    (25 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=============>   (26 + 8) / 34][Stage 6:>                 (0 + 0) / 47][Stage 5:=============>   (27 + 7) / 34][Stage 6:>                 (0 + 1) / 47][Stage 5:==============>  (28 + 6) / 34][Stage 6:>                 (0 + 2) / 47][Stage 5:==============>  (29 + 5) / 34][Stage 6:>                 (0 + 3) / 47][Stage 5:===============> (30 + 4) / 34][Stage 6:>                 (0 + 4) / 47][Stage 5:===============> (31 + 3) / 34][Stage 6:>                 (0 + 5) / 47][Stage 5:===============> (31 + 3) / 34][Stage 6:>                 (1 + 5) / 47][Stage 5:===============> (31 + 3) / 34][Stage 6:=>                (3 + 5) / 47][Stage 5:================>(32 + 2) / 34][Stage 6:=>                (3 + 6) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:=>                (3 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:=>                (4 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:=>                (5 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:==>               (6 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:===>              (9 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:===>             (10 + 7) / 47][Stage 5:================>(33 + 1) / 34][Stage 6:===>             (11 + 7) / 47][Stage 6:==============>                                          (12 + 8) / 47][Stage 6:===============>                                         (13 + 8) / 47][Stage 6:==================>                                      (15 + 8) / 47][Stage 6:===================>                                     (16 + 8) / 47][Stage 6:====================>                                    (17 + 8) / 47][Stage 6:========================>                                (20 + 8) / 47][Stage 6:=========================>                               (21 + 8) / 47][Stage 6:===========================>                             (23 + 8) / 47][Stage 6:=============================>                           (24 + 8) / 47][Stage 6:==============================>                          (25 + 8) / 47][Stage 6:=================================>                       (28 + 8) / 47][Stage 6:===================================>                     (29 + 8) / 47][Stage 6:====================================>                    (30 + 8) / 47][Stage 6:======================================>                  (32 + 8) / 47][Stage 6:========================================>                (33 + 8) / 47][Stage 6:==========================================>              (35 + 8) / 47][Stage 6:===========================================>             (36 + 8) / 47][Stage 6:============================================>            (37 + 8) / 47][Stage 6:==============================================>          (38 + 8) / 47][Stage 6:================================================>        (40 + 7) / 47][Stage 6:=================================================>       (41 + 6) / 47][Stage 6:=====================================================>   (44 + 3) / 47][Stage 6:=======================================================> (46 + 1) / 47][Stage 7:=>                                                       (7 + 8) / 200][Stage 7:==>                                                      (8 + 8) / 200][Stage 7:===>                                                    (13 + 8) / 200][Stage 7:====>                                                   (17 + 8) / 200][Stage 7:======>                                                 (24 + 8) / 200][Stage 7:=======>                                                (26 + 8) / 200][Stage 7:=========>                                              (33 + 8) / 200][Stage 7:=========>                                              (34 + 8) / 200][Stage 7:===========>                                            (42 + 8) / 200][Stage 7:============>                                           (44 + 8) / 200][Stage 7:==============>                                         (50 + 8) / 200][Stage 7:===============>                                        (54 + 9) / 200][Stage 7:================>                                       (60 + 8) / 200][Stage 7:=================>                                      (63 + 8) / 200][Stage 7:==================>                                     (67 + 8) / 200][Stage 7:====================>                                   (72 + 8) / 200][Stage 7:=====================>                                  (77 + 8) / 200][Stage 7:======================>                                 (80 + 8) / 200][Stage 7:========================>                               (87 + 8) / 200][Stage 7:==========================>                             (93 + 8) / 200][Stage 7:===========================>                            (99 + 8) / 200][Stage 7:=============================>                         (106 + 8) / 200][Stage 7:==============================>                        (111 + 8) / 200][Stage 7:===============================>                       (115 + 8) / 200][Stage 7:=================================>                     (122 + 8) / 200][Stage 7:===================================>                   (128 + 8) / 200][Stage 7:====================================>                  (131 + 8) / 200][Stage 7:=====================================>                 (138 + 8) / 200][Stage 7:=======================================>               (144 + 8) / 200][Stage 7:========================================>              (148 + 8) / 200][Stage 7:==========================================>            (155 + 8) / 200][Stage 7:===========================================>           (157 + 8) / 200][Stage 7:============================================>          (161 + 8) / 200][Stage 7:=============================================>         (164 + 8) / 200][Stage 7:==============================================>        (168 + 8) / 200][Stage 7:===============================================>       (173 + 8) / 200][Stage 7:=================================================>     (179 + 8) / 200][Stage 7:==================================================>    (185 + 8) / 200][Stage 7:===================================================>   (189 + 8) / 200][Stage 7:=====================================================> (195 + 5) / 200][Stage 8:==================================================>    (183 + 8) / 200]                                                                                res1: Long = 0
[Stage 10:>                (0 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:>                (1 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=>               (5 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:==>              (8 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===>             (9 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===>            (10 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===>            (11 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:====>           (13 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:====>           (14 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=====>          (16 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=====>          (17 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:======>         (19 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:======>         (20 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=======>        (22 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:========>       (24 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:========>       (25 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:========>       (26 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=========>      (28 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:==========>     (30 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:==========>     (32 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===========>    (33 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===========>    (34 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:===========>    (35 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:============>   (36 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:============>   (38 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=============>  (39 + 8) / 47][Stage 11:>                (0 + 0) / 34][Stage 10:=============>  (41 + 6) / 47][Stage 11:>                (1 + 2) / 34][Stage 10:=============>  (41 + 6) / 47][Stage 11:=>               (2 + 2) / 34][Stage 10:==============> (42 + 5) / 47][Stage 11:=>               (2 + 3) / 34][Stage 10:==============> (44 + 3) / 47][Stage 11:==>              (4 + 5) / 34][Stage 10:===============>(45 + 2) / 47][Stage 11:==>              (4 + 6) / 34][Stage 11:======>                                                  (4 + 8) / 34][Stage 11:========>                                                (5 + 8) / 34][Stage 11:===========>                                             (7 + 8) / 34][Stage 11:=============>                                           (8 + 8) / 34][Stage 11:===============>                                         (9 + 8) / 34][Stage 11:================>                                       (10 + 8) / 34][Stage 11:==================>                                     (11 + 8) / 34][Stage 11:===================>                                    (12 + 8) / 34][Stage 11:==========================>                             (16 + 8) / 34][Stage 11:============================>                           (17 + 8) / 34][Stage 11:===============================>                        (19 + 8) / 34][Stage 11:================================>                       (20 + 8) / 34][Stage 11:====================================>                   (22 + 8) / 34][Stage 11:=====================================>                  (23 + 8) / 34][Stage 11:=========================================>              (25 + 8) / 34][Stage 11:==========================================>             (26 + 8) / 34][Stage 11:============================================>           (27 + 7) / 34][Stage 11:==============================================>         (28 + 6) / 34][Stage 11:===============================================>        (29 + 5) / 34][Stage 11:=================================================>      (30 + 4) / 34][Stage 11:===================================================>    (31 + 3) / 34][Stage 11:====================================================>   (32 + 2) / 34][Stage 11:======================================================> (33 + 1) / 34][Stage 12:=>                                                      (5 + 8) / 200][Stage 12:==>                                                     (8 + 8) / 200][Stage 12:===>                                                   (11 + 8) / 200][Stage 12:===>                                                   (13 + 8) / 200][Stage 12:====>                                                  (16 + 8) / 200][Stage 12:=====>                                                 (21 + 8) / 200][Stage 12:======>                                                (23 + 8) / 200][Stage 12:=======>                                               (29 + 8) / 200][Stage 12:========>                                              (32 + 8) / 200][Stage 12:==========>                                            (38 + 8) / 200][Stage 12:============>                                          (45 + 8) / 200][Stage 12:=============>                                         (48 + 8) / 200][Stage 12:===============>                                       (55 + 8) / 200][Stage 12:================>                                      (61 + 8) / 200][Stage 12:=================>                                     (65 + 8) / 200][Stage 12:===================>                                   (72 + 8) / 200][Stage 12:=====================>                                 (77 + 8) / 200][Stage 12:======================>                                (82 + 8) / 200][Stage 12:=======================>                               (85 + 8) / 200][Stage 12:=========================>                             (93 + 8) / 200][Stage 12:===========================>                           (99 + 8) / 200][Stage 12:===========================>                          (103 + 8) / 200][Stage 12:=============================>                        (109 + 8) / 200][Stage 12:===============================>                      (117 + 8) / 200][Stage 12:================================>                     (122 + 8) / 200][Stage 12:=================================>                    (125 + 8) / 200][Stage 12:===================================>                  (133 + 8) / 200][Stage 12:=====================================>                (140 + 8) / 200][Stage 12:======================================>               (141 + 8) / 200][Stage 12:========================================>             (149 + 8) / 200][Stage 12:==========================================>           (156 + 8) / 200][Stage 12:===========================================>          (160 + 8) / 200][Stage 12:============================================>         (165 + 8) / 200][Stage 12:==============================================>       (173 + 8) / 200][Stage 12:================================================>     (178 + 8) / 200][Stage 12:=================================================>    (183 + 8) / 200][Stage 12:===================================================>  (190 + 8) / 200][Stage 12:=====================================================>(197 + 3) / 200]                                                                                +----+-----+---+--------+--------+-------+-------+---------+--------+---------+-----+--------+-------+---------+-------+------+-------+-----+-----------------+---------------+----------+------+----------+----------+-------+------+------------------+---------+--------------+------------------+-----------------+--------------+-----------------+----------------------+----------------------+-------------------+-----------+
|acct|cusip|rr |pend_qty|cur_cost|cur_qty|seg_qty|memo_only|memo_qty|memo_cost|short|last_usr|last_dt|last_time|mkt_val|ln_val|sfk_qty|sgreq|nm_loan_val_house|nm_loan_val_reg|nm_mkt_val|nm_qty|undr_cusip|nm_sfk_qty|off_qty|nm_wmv|nm_loan_val_custom|cost_stat|cost_stat_ovrd|cost_stat_ovrd_usr|cost_stat_ovrd_dt|cost_stat_calc|cost_stat_asof_dt|cost_stat_asof_dt_calc|cost_stat_asof_dt_ovrd|cost_stat_ovrd_memo|broker_code|
+----+-----+---+--------+--------+-------+-------+---------+--------+---------+-----+--------+-------+---------+-------+------+-------+-----+-----------------+---------------+----------+------+----------+----------+-------+------+------------------+---------+--------------+------------------+-----------------+--------------+-----------------+----------------------+----------------------+-------------------+-----------+
+----+-----+---+--------+--------+-------+-------+---------+--------+---------+-----+--------+-------+---------+-------+------+-------+-----+-----------------+---------------+----------+------+----------+----------+-------+------+------------------+---------+--------------+------------------+-----------------+--------------+-----------------+----------------------+----------------------+-------------------+-----------+


scala> 

scala> :quit
