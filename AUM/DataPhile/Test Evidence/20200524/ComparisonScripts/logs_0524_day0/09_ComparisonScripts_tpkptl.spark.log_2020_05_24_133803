Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://azcedledgev001.v01caedl.manulife.com:4040
Spark context available as 'sc' (master = local[*], app id = local-1590341893713).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.3.0.2.6.5.149-2
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_241)
Type in expressions to have them evaluated.
Type :help for more information.

scala> val t_process_date = "2020-05-17"
t_process_date: String = 2020-05-17

scala> val s_process_date = "2020-05-01"
s_process_date: String = 2020-05-01

scala> :load '09_ComparisonScripts_tpkptl.spark' 
Loading 09_ComparisonScripts_tpkptl.spark...
r1: org.apache.spark.sql.DataFrame = [proc_dt: date, trd_num: int ... 7 more fields]
r2: org.apache.spark.sql.DataFrame = [proc_dt: date, trd_num: int ... 7 more fields]
diff: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [proc_dt: date, trd_num: int ... 7 more fields]
[Stage 0:>                 (0 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:>                 (1 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=>                (2 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:===>              (7 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:====>             (8 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=====>            (9 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=====>           (10 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=====>           (11 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=======>         (14 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:========>        (16 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=========>       (17 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=========>       (18 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:==========>      (19 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:===========>     (22 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:============>    (24 + 8) / 32][Stage 1:>                 (0 + 0) / 21][Stage 0:=============>   (25 + 7) / 32][Stage 1:>                 (1 + 1) / 21][Stage 0:=============>   (26 + 6) / 32][Stage 1:>                 (1 + 2) / 21][Stage 0:==============>  (27 + 5) / 32][Stage 1:>                 (1 + 3) / 21][Stage 0:===============> (30 + 2) / 32][Stage 1:>                 (1 + 6) / 21][Stage 1:==>                                                       (1 + 8) / 21][Stage 1:=====>                                                    (2 + 8) / 21][Stage 1:========>                                                 (3 + 8) / 21][Stage 1:=============>                                            (5 + 8) / 21][Stage 1:===================>                                      (7 + 8) / 21][Stage 1:======================>                                   (8 + 8) / 21][Stage 1:========================>                                 (9 + 8) / 21][Stage 1:=============================>                           (11 + 8) / 21][Stage 1:===================================>                     (13 + 8) / 21][Stage 1:========================================>                (15 + 6) / 21][Stage 1:===========================================>             (16 + 5) / 21][Stage 1:==============================================>          (17 + 4) / 21][Stage 1:===================================================>     (19 + 2) / 21][Stage 2:>                                                        (0 + 8) / 200][Stage 2:>                                                        (3 + 8) / 200][Stage 2:==>                                                      (9 + 8) / 200][Stage 2:====>                                                   (16 + 8) / 200][Stage 2:=====>                                                  (21 + 8) / 200][Stage 2:========>                                               (29 + 8) / 200][Stage 2:==========>                                             (37 + 8) / 200][Stage 2:============>                                           (46 + 8) / 200][Stage 2:==============>                                         (53 + 8) / 200][Stage 2:=================>                                      (61 + 8) / 200][Stage 2:===================>                                    (69 + 8) / 200][Stage 2:=====================>                                  (75 + 8) / 200][Stage 2:=====================>                                  (78 + 8) / 200][Stage 2:=======================>                                (85 + 8) / 200][Stage 2:==========================>                             (94 + 8) / 200][Stage 2:===========================>                           (101 + 8) / 200][Stage 2:=============================>                         (107 + 8) / 200][Stage 2:===============================>                       (113 + 8) / 200][Stage 2:================================>                      (118 + 8) / 200][Stage 2:=================================>                     (122 + 8) / 200][Stage 2:==================================>                    (124 + 8) / 200][Stage 2:==================================>                    (127 + 8) / 200][Stage 2:====================================>                  (131 + 8) / 200][Stage 2:====================================>                  (132 + 8) / 200][Stage 2:=====================================>                 (135 + 8) / 200][Stage 2:======================================>                (140 + 8) / 200][Stage 2:=======================================>               (145 + 8) / 200][Stage 2:=========================================>             (152 + 8) / 200][Stage 2:===========================================>           (157 + 8) / 200][Stage 2:=============================================>         (166 + 9) / 200][Stage 2:===============================================>       (173 + 8) / 200][Stage 2:==================================================>    (182 + 8) / 200][Stage 2:====================================================>  (190 + 8) / 200][Stage 3:==============================================>        (169 + 9) / 200]                                                                                Count with mismatches = 0
[Stage 5:>                 (1 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:=>                (2 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:==>               (3 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:===>              (4 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:====>             (5 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:=====>            (6 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:======>           (7 + 9) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:=======>          (9 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:========>        (10 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:=========>       (12 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:==========>      (13 + 8) / 21][Stage 6:>                 (0 + 0) / 32][Stage 5:============>    (16 + 5) / 21][Stage 6:>                 (0 + 3) / 32][Stage 5:=============>   (17 + 4) / 21][Stage 6:>                 (0 + 4) / 32][Stage 5:===============> (19 + 2) / 21][Stage 6:>                 (0 + 6) / 32][Stage 5:================>(20 + 1) / 21][Stage 6:=>                (2 + 7) / 32][Stage 6:=======>                                                  (4 + 8) / 32][Stage 6:=========>                                                (5 + 8) / 32][Stage 6:==========>                                               (6 + 8) / 32][Stage 6:============>                                             (7 + 8) / 32][Stage 6:================>                                         (9 + 8) / 32][Stage 6:===================>                                     (11 + 8) / 32][Stage 6:=====================>                                   (12 + 8) / 32][Stage 6:=======================>                                 (13 + 8) / 32][Stage 6:========================>                                (14 + 8) / 32][Stage 6:==========================>                              (15 + 8) / 32][Stage 6:==============================>                          (17 + 8) / 32][Stage 6:=================================>                       (19 + 8) / 32][Stage 6:===================================>                     (20 + 8) / 32][Stage 6:=====================================>                   (21 + 8) / 32][Stage 6:=======================================>                 (22 + 8) / 32][Stage 6:==========================================>              (24 + 8) / 32][Stage 6:=================================================>       (28 + 4) / 32][Stage 6:===================================================>     (29 + 3) / 32][Stage 6:=====================================================>   (30 + 2) / 32][Stage 7:=======>                                                (26 + 8) / 200][Stage 7:=========>                                              (34 + 8) / 200][Stage 7:===========>                                            (41 + 8) / 200][Stage 7:=============>                                          (49 + 8) / 200][Stage 7:===============>                                        (57 + 8) / 200][Stage 7:===================>                                    (68 + 8) / 200][Stage 7:=====================>                                  (77 + 8) / 200][Stage 7:=========================>                              (90 + 8) / 200][Stage 7:===========================>                           (100 + 8) / 200][Stage 7:==============================>                        (111 + 8) / 200][Stage 7:=================================>                     (120 + 8) / 200][Stage 7:====================================>                  (132 + 8) / 200][Stage 7:=======================================>               (143 + 8) / 200][Stage 7:=========================================>             (150 + 8) / 200][Stage 7:============================================>          (160 + 8) / 200][Stage 7:==============================================>        (170 + 8) / 200][Stage 7:================================================>      (178 + 9) / 200][Stage 7:====================================================>  (192 + 8) / 200]                                                                                res1: Long = 0
[Stage 10:>                (0 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:>                (1 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:=>               (2 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:=>               (3 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:==>              (5 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:====>            (8 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:====>            (9 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:=====>          (10 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:======>         (13 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:=======>        (15 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:========>       (16 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:========>       (17 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:=========>      (19 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:==========>     (21 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:===========>    (23 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:============>   (24 + 8) / 32][Stage 11:>                (0 + 0) / 21][Stage 10:============>   (25 + 7) / 32][Stage 11:>                (1 + 1) / 21][Stage 10:=============>  (27 + 5) / 32][Stage 11:>                (1 + 3) / 21][Stage 10:==============> (29 + 3) / 32][Stage 11:>                (1 + 5) / 21][Stage 10:===============>(30 + 2) / 32][Stage 11:>                (1 + 6) / 21][Stage 11:==>                                                      (1 + 8) / 21][Stage 11:=====>                                                   (2 + 8) / 21][Stage 11:========>                                                (3 + 8) / 21][Stage 11:==========>                                              (4 + 8) / 21][Stage 11:=============>                                           (5 + 8) / 21][Stage 11:================>                                        (6 + 8) / 21][Stage 11:=====================>                                   (8 + 8) / 21][Stage 11:========================>                                (9 + 8) / 21][Stage 11:==========================>                             (10 + 8) / 21][Stage 11:=============================>                          (11 + 8) / 21][Stage 11:================================>                       (12 + 8) / 21][Stage 11:==================================>                     (13 + 8) / 21][Stage 11:=====================================>                  (14 + 7) / 21][Stage 11:==========================================>             (16 + 5) / 21][Stage 11:================================================>       (18 + 3) / 21][Stage 11:==================================================>     (19 + 2) / 21][Stage 11:=====================================================>  (20 + 1) / 21][Stage 12:===>                                                   (11 + 8) / 200][Stage 12:=====>                                                 (19 + 8) / 200][Stage 12:=======>                                               (28 + 8) / 200][Stage 12:=========>                                             (34 + 8) / 200][Stage 12:===========>                                           (42 + 8) / 200][Stage 12:=============>                                         (48 + 8) / 200][Stage 12:===============>                                       (55 + 8) / 200][Stage 12:=================>                                     (63 + 8) / 200][Stage 12:==================>                                    (69 + 8) / 200][Stage 12:===================>                                   (72 + 8) / 200][Stage 12:=====================>                                 (77 + 8) / 200][Stage 12:======================>                                (80 + 8) / 200][Stage 12:=======================>                               (85 + 8) / 200][Stage 12:========================>                              (88 + 8) / 200][Stage 12:=========================>                             (93 + 8) / 200][Stage 12:==========================>                            (96 + 8) / 200][Stage 12:============================>                         (104 + 8) / 200][Stage 12:==============================>                       (114 + 8) / 200][Stage 12:=================================>                    (123 + 8) / 200][Stage 12:===================================>                  (132 + 8) / 200][Stage 12:=====================================>                (140 + 8) / 200][Stage 12:=======================================>              (148 + 8) / 200][Stage 12:===========================================>          (160 + 8) / 200][Stage 12:============================================>         (165 + 8) / 200][Stage 12:===============================================>      (175 + 8) / 200][Stage 12:=================================================>    (185 + 8) / 200][Stage 12:====================================================> (194 + 6) / 200]                                                                                +-------+-------+-------+-------+--------+-----------+---------+--------+-----------+
|proc_dt|trd_num|last_dt|tlr_num|tlr_text|client_side|last_time|last_usr|broker_code|
+-------+-------+-------+-------+--------+-----------+---------+--------+-----------+
+-------+-------+-------+-------+--------+-----------+---------+--------+-----------+


scala> 

scala> :quit
