Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://azcedledgev001.v01caedl.manulife.com:4040
Spark context available as 'sc' (master = local[*], app id = local-1590340196667).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.3.0.2.6.5.149-2
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_241)
Type in expressions to have them evaluated.
Type :help for more information.

scala> val t_process_date = "2020-05-24"
t_process_date: String = 2020-05-24

scala> val s_process_date = "2020-05-02"
s_process_date: String = 2020-05-02

scala> :load '16_ComparisonScripts_gncode.spark' 
Loading 16_ComparisonScripts_gncode.spark...
r1: org.apache.spark.sql.DataFrame = [code: string, code_value: string ... 8 more fields]
r2: org.apache.spark.sql.DataFrame = [code: string, code_value: string ... 8 more fields]
diff: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [code: string, code_value: string ... 8 more fields]
[Stage 0:>                 (0 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:>                 (1 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=>                (2 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=>                (3 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:==>               (4 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:====>             (7 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:====>             (8 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=====>            (9 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=====>           (10 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:======>          (11 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:======>          (12 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=======>         (13 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=======>         (14 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:========>        (15 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=========>       (17 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:==========>      (19 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:============>    (22 + 8) / 30][Stage 1:>                 (0 + 0) / 13][Stage 0:=============>   (23 + 7) / 30][Stage 1:>                 (0 + 1) / 13][Stage 0:=============>   (24 + 6) / 30][Stage 1:>                 (0 + 2) / 13][Stage 0:==============>  (25 + 5) / 30][Stage 1:>                 (0 + 3) / 13][Stage 0:===============> (28 + 2) / 30][Stage 1:>                 (0 + 6) / 13][Stage 0:================>(29 + 1) / 30][Stage 1:>                 (0 + 7) / 13][Stage 1:>                                                         (0 + 8) / 13][Stage 1:====>                                                     (1 + 8) / 13][Stage 1:========>                                                 (2 + 8) / 13][Stage 1:=============>                                            (3 + 8) / 13][Stage 1:=================>                                        (4 + 8) / 13][Stage 1:===============================>                          (7 + 6) / 13][Stage 1:===================================>                      (8 + 5) / 13][Stage 1:========================================>                 (9 + 4) / 13][Stage 1:================================================>        (11 + 2) / 13][Stage 1:====================================================>    (12 + 1) / 13][Stage 2:>                                                        (0 + 8) / 200][Stage 2:==>                                                      (8 + 8) / 200][Stage 2:===>                                                    (11 + 8) / 200][Stage 2:=====>                                                  (19 + 8) / 200][Stage 2:=======>                                                (25 + 8) / 200][Stage 2:========>                                               (30 + 8) / 200][Stage 2:=========>                                              (34 + 8) / 200][Stage 2:==========>                                             (38 + 8) / 200][Stage 2:============>                                           (43 + 8) / 200][Stage 2:============>                                           (46 + 8) / 200][Stage 2:=============>                                          (49 + 8) / 200][Stage 2:===============>                                        (57 + 8) / 200][Stage 2:=================>                                      (63 + 8) / 200][Stage 2:===================>                                    (70 + 8) / 200][Stage 2:=====================>                                  (77 + 8) / 200][Stage 2:=======================>                                (85 + 8) / 200][Stage 2:==========================>                             (93 + 8) / 200][Stage 2:===========================>                            (98 + 8) / 200][Stage 2:============================>                          (102 + 8) / 200][Stage 2:=============================>                         (107 + 8) / 200][Stage 2:===============================>                       (114 + 8) / 200][Stage 2:=================================>                     (120 + 8) / 200][Stage 2:=====================================>                 (135 + 8) / 200][Stage 2:=======================================>               (143 + 8) / 200][Stage 2:=========================================>             (151 + 8) / 200][Stage 2:===========================================>           (159 + 8) / 200][Stage 2:=============================================>         (164 + 8) / 200][Stage 2:==============================================>        (169 + 8) / 200][Stage 2:================================================>      (175 + 8) / 200][Stage 2:==================================================>    (183 + 8) / 200][Stage 2:=====================================================> (193 + 7) / 200][Stage 3:===================================>                   (130 + 8) / 200][Stage 3:===============================================>       (171 + 8) / 200]                                                                                Count with mismatches = 6
[Stage 5:>                 (0 + 8) / 13][Stage 6:>                 (0 + 0) / 30][Stage 5:=>                (1 + 8) / 13][Stage 6:>                 (0 + 0) / 30][Stage 5:==>               (2 + 8) / 13][Stage 6:>                 (0 + 0) / 30][Stage 5:=====>            (4 + 8) / 13][Stage 6:>                 (0 + 0) / 30][Stage 5:========>         (6 + 7) / 13][Stage 6:>                 (0 + 1) / 30][Stage 5:===========>      (8 + 5) / 13][Stage 6:>                 (0 + 3) / 30][Stage 5:===========>      (8 + 5) / 13][Stage 6:>                 (1 + 3) / 30][Stage 5:============>     (9 + 4) / 13][Stage 6:>                 (1 + 4) / 30][Stage 5:============>     (9 + 4) / 13][Stage 6:=>                (2 + 4) / 30][Stage 5:=============>   (10 + 3) / 13][Stage 6:=>                (2 + 5) / 30][Stage 5:==============>  (11 + 2) / 13][Stage 6:=>                (2 + 6) / 30][Stage 6:===>                                                      (2 + 8) / 30][Stage 6:=====>                                                    (3 + 8) / 30][Stage 6:=========>                                                (5 + 8) / 30][Stage 6:===========>                                              (6 + 8) / 30][Stage 6:=============>                                            (7 + 8) / 30][Stage 6:===============>                                          (8 + 8) / 30][Stage 6:=================>                                        (9 + 8) / 30][Stage 6:===================>                                     (10 + 8) / 30][Stage 6:======================>                                  (12 + 8) / 30][Stage 6:========================>                                (13 + 8) / 30][Stage 6:==========================>                              (14 + 8) / 30][Stage 6:==============================>                          (16 + 8) / 30][Stage 6:====================================>                    (19 + 8) / 30][Stage 6:======================================>                  (20 + 8) / 30][Stage 6:=======================================>                 (21 + 8) / 30][Stage 6:=========================================>               (22 + 8) / 30][Stage 6:===========================================>             (23 + 7) / 30][Stage 6:=================================================>       (26 + 4) / 30][Stage 6:===================================================>     (27 + 3) / 30][Stage 6:=======================================================> (29 + 1) / 30][Stage 7:=======>                                                (25 + 8) / 200][Stage 7:==========>                                             (38 + 8) / 200][Stage 7:=============>                                          (47 + 8) / 200][Stage 7:===============>                                        (54 + 8) / 200][Stage 7:=================>                                      (62 + 8) / 200][Stage 7:===================>                                    (71 + 8) / 200][Stage 7:======================>                                 (80 + 8) / 200][Stage 7:=========================>                              (92 + 8) / 200][Stage 7:===========================>                           (101 + 8) / 200][Stage 7:==============================>                        (110 + 8) / 200][Stage 7:================================>                      (119 + 8) / 200][Stage 7:==================================>                    (127 + 8) / 200][Stage 7:=====================================>                 (137 + 8) / 200][Stage 7:=======================================>               (145 + 8) / 200][Stage 7:==========================================>            (154 + 8) / 200][Stage 7:=============================================>         (165 + 8) / 200][Stage 7:===============================================>       (171 + 8) / 200][Stage 7:==================================================>    (184 + 8) / 200][Stage 8:====================================================>  (190 + 9) / 200]                                                                                res1: Long = 6
[Stage 10:>                (0 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:>                (1 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=>               (3 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:==>              (5 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:===>             (7 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:====>            (8 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=====>           (9 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=====>          (11 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:======>         (13 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=======>        (14 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:========>       (15 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:========>       (16 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=========>      (17 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:=========>      (18 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:==========>     (20 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:===========>    (22 + 8) / 30][Stage 11:>                (0 + 0) / 13][Stage 10:============>   (23 + 7) / 30][Stage 11:>                (0 + 1) / 13][Stage 10:=============>  (26 + 4) / 30][Stage 11:>                (0 + 4) / 13][Stage 10:==============> (27 + 3) / 30][Stage 11:>                (0 + 5) / 13][Stage 10:==============> (28 + 2) / 30][Stage 11:>                (0 + 6) / 13][Stage 10:===============>(29 + 1) / 30][Stage 11:>                (0 + 7) / 13][Stage 11:>                                                        (0 + 8) / 13][Stage 11:====>                                                    (1 + 8) / 13][Stage 11:=============>                                           (3 + 8) / 13][Stage 11:=================>                                       (4 + 8) / 13][Stage 11:=====================>                                   (5 + 8) / 13][Stage 11:==============================>                          (7 + 6) / 13][Stage 11:===================================>                     (8 + 5) / 13][Stage 11:===========================================>            (10 + 3) / 13][Stage 11:===================================================>    (12 + 1) / 13][Stage 12:========>                                              (32 + 8) / 200][Stage 12:===========>                                           (42 + 8) / 200][Stage 12:===============>                                       (57 + 8) / 200][Stage 12:====================>                                  (73 + 8) / 200][Stage 12:======================>                                (83 + 8) / 200][Stage 12:==========================>                            (98 + 8) / 200][Stage 12:=============================>                        (111 + 8) / 200][Stage 12:==================================>                   (127 + 8) / 200][Stage 12:=====================================>                (138 + 8) / 200][Stage 12:=========================================>            (152 + 8) / 200][Stage 12:===========================================>          (162 + 8) / 200][Stage 12:==============================================>       (171 + 8) / 200][Stage 12:==================================================>   (186 + 8) / 200]                                                                                +------------+----------+----------+-----------------------------------------------------------------------+---------+---------+---------+----------+---------+-----------+
|code        |code_value|last_dt   |descr                                                                  |subsystem|last_time|last_usr |table_name|dec_value|broker_code|
+------------+----------+----------+-----------------------------------------------------------------------+---------+---------+---------+----------+---------+-----------+
|BISTL_EXC2  |          |2020-05-24|0 BI cluster(s) in use (0% of total 28),(0% of current BI chain of 14).|         |11:20:02 |bi-ctrl.p|CTRL      |0E-8     |MSII       |
|BISTL_EXC2  |          |2020-05-24|0 BI cluster(s) in use (0% of total 45),(0% of current BI chain of 14).|         |10:50:01 |bi-ctrl.p|CTRL      |0E-8     |MSI        |
|BISTL_EXC2SM|          |2020-05-24|0 BI cluster(s) in use (0% of total 59),(0% of current BI chain of 14).|         |10:50:01 |bi-ctrl.p|CTRL      |0E-8     |MSI        |
|BISTL_EXC2SM|          |2020-05-24|0 BI cluster(s) in use (0% of total 59),(0% of current BI chain of 14).|         |11:08:01 |bi-ctrl.p|CTRL      |0E-8     |MSISI      |
|BISTL_EXC2  |          |2020-05-24|0 BI cluster(s) in use (0% of total 45),(0% of current BI chain of 14).|         |11:08:01 |bi-ctrl.p|CTRL      |0E-8     |MSISI      |
|BISTL_EXC2SM|          |2020-05-24|0 BI cluster(s) in use (0% of total 59),(0% of current BI chain of 14).|         |11:20:02 |bi-ctrl.p|CTRL      |0E-8     |MSII       |
+------------+----------+----------+-----------------------------------------------------------------------+---------+---------+---------+----------+---------+-----------+


scala> 

scala> :quit
